define(["jquery","core/log","atto_subtitle/vtthelper"],function(a,b,c){"use strict";return b.debug("Atto Subtitle import/export initialising"),{exportvtt:function(a,b){var d=document.createElement("a"),e=c.convertJsonToVtt(b);d.setAttribute("href","data:text/vtt;charset=utf-8,"+encodeURIComponent(e)),d.setAttribute("download",a+".vtt"),d.style.display="none",document.body.appendChild(d),d.click(),document.body.removeChild(d)},init:function(b){var d=this,e="#poodllsubtitle_dragdropsquare";a(e).on("click",function(a){var c=b.fetchSubtitleData();d.exportvtt("captions",c)}),a(e).on("dragover",function(b){b.preventDefault(),b.stopPropagation(),a(this).addClass("poodllsubtitle_dragging")}),a(e).on("dragleave",function(b){b.preventDefault(),b.stopPropagation(),a(this).removeClass("poodllsubtitle_dragging")}),a(e).on("drop",function(d){d.preventDefault();var e=d.originalEvent.dataTransfer.files;if(e.length){var f=e[0];if(f){var g=new FileReader;g.onload=function(a){var d=a.target.result;if(d){var e=c.convertVttToJson(d);b.resetData(e)}},g.readAsText(f)}else alert("Failed to load file")}a(this).removeClass("poodllsubtitle_dragging")})}}});